<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>programa de fala</title>

</head>
<body>
Selecionar voz:<select id="voicelist"></select><br><br>
<input id="txtinput" /><br><br>
<button id="btnSpeak" > Falar!</button>
  
<script>
      var txtinput = document.querySelector('#txtinput')
  var voiceList = document.querySelector('#voiceList')
  var btnspeak = document.querySelector('#btnSpeak')
  var synth = window.speechSynthesis;
  var voices = []

  Newvoices()
  if (speechSynthesis !== undefined) {
    speechSynthesis.onvoiceschanged = Newvoices
  }

btnspeak.addEventListener('click', () => {
var tospeak = new SpeechSynthesisUtterance(txtinput.innerHTML)
var selectedVoiceName = voiceList.selectedOptions[0].getAttribute('data-name');
voices.forEach((voice) => {
  if(voice.name === selectedVoiceName) {
    tospeak.voice = voice
  }
})

if(synth.speaking){
 synth.cancel()
}else{
synth.speak(tospeak);
}
})

function Newvoices () {
  voices = synth.getVoices()
  var selectedindex = voiceList.selectedindex < 0 ? 0 : voiceList.selectedindex
  voiceList.inneHTML = ''
  voices.forEach((voice) => {
    var listItem = document.createElement('option')
    listItem.textContent = voice.name
    listItem.setAttribute('data-lang', voice.lang)
    listItem.setAttribute('data-name', voice.name)
    voiceList.appendChild(listItem)

})

voiceList.selectedindex = selectedindex


}

 


  
  </script>

</body>
</html>

